(function(){var Warper;Warper=function(){function Warper(){this.check_compatibility(),this.attach_ux(),null!=window.SALT_DEFAULT&&($("#salt").val(window.SALT_DEFAULT),$("#salt").attr("disabled",!0),$(".salt-label").text("Prefilled salt"))}return Warper.prototype.check_compatibility=function(){return"undefined"==typeof Int32Array||null===Int32Array?$(".form-container").html("<p>\n  Sorry, but your browser is too old to run WarpWallet, which requires Int32Array support.\n</p>"):void 0},Warper.prototype.attach_ux=function(){return $("#btn-submit").on("click",function(_this){return function(){return _this.click_submit()}}(this)),$("#btn-reset").on("click",function(_this){return function(){return _this.click_reset()}}(this)),$("#salt").on("change",function(_this){return function(){return _this.salt_change()}}(this)),$("#salt").on("keyup",function(_this){return function(){return _this.salt_change()}}(this)),$("#checkbox-salt-confirm").on("click",function(_this){return function(){return _this.any_change()}}(this)),$("#passphrase").on("change",function(_this){return function(){return _this.any_change()}}(this)),$("#passphrase").on("keyup",function(_this){return function(){return _this.any_change()}}(this)),$("#public-address").on("click",function(){return $(this).select()}),$("#private-key").on("click",function(){return $(this).select()}),$(".what-salt").on("click",function(_this){return function(){return $(".salt-explanation").toggle()}}(this))},Warper.prototype.any_change=function(){var chk,err,pp,salt,warn;return $(".progress-form").hide(),$("#private-key").val(""),$("#public-address").val(""),$("#btn-submit").attr("disabled",!1).show().html("Generate"),pp=$("#passphrase").val(),salt=$("#salt").val(),chk=$("#checkbox-salt-confirm").is(":checked"),err=null,warn=null,pp.length?(null!=salt?salt.length:void 0)&&!this.salt_ok()?err="Fix your salt":(null!=salt?salt.length:void 0)&&!chk&&null==window.SALT_DEFAULT?err="Confirm your salt":pp.length<12&&(warn="Consider a larger passphrase"):err="Please enter a passphrase",err?$("#btn-submit").attr("disabled",!0).html(err):warn?$("#btn-submit").attr("disabled",!1).html(warn):$("#btn-submit").attr("disabled",!1).html("Generate"),$(".output-form").hide(),$("#public-address-qr").html(""),$("#private-key-qr").html("")},Warper.prototype.commas=function(n){for(;/(\d+)(\d{3})/.test(n.toString());)n=n.toString().replace(/(\d+)(\d{3})/,"$1,$2");return n},Warper.prototype.salt_ok=function(){var salt;return salt=$("#salt").val(),salt.match(/^[\S]+@[\S]+\.[\S]+$/)||null!=window.SALT_DEFAULT},Warper.prototype.salt_change=function(){var salt;return salt=$("#salt").val(),$("#checkbox-salt-confirm").attr("checked",!1),salt.length||$(".salt-confirm").hide(),null!=window.SALT_DEFAULT?$(".salt-confirm").hide():this.salt_ok()?($(".salt-confirm").show(),$(".salt-summary").text(salt)):$(".salt-confirm").hide(),this.any_change()},Warper.prototype.progress_hook=function(o){var w;return"scrypt"===o.what?(w=o.i/o.total*50,$(".progress-form .bar").css("width",w+"%"),$(".progress-form .bar .progress-scrypt").html("scrypt "+this.commas(o.i)+" of "+this.commas(o.total))):"pbkdf2"===o.what?(w=50+o.i/o.total*50,$(".progress-form .bar").css("width",w+"%"),$(".progress-form .bar .progress-pbkdf2").html("&nbsp; pbkdf2 "+this.commas(o.i)+" of "+this.commas(o.total))):void 0},Warper.prototype.click_reset=function(){return $("#btn-submit").attr("disabled",!1).show().html("Please enter a passphrase"),$("#passphrase, #public-address, #private-key").val(""),null==window.SALT_DEFAULT&&$("#salt").val(""),$("#checkbox-salt-confirm").attr("checked",!1),$(".salt-summary").html(""),$(".salt-confirm").hide(),$(".progress-form").hide(),$(".output-form").hide(),$("#public-address-qr").html(""),$("#private-key-qr").html("")},Warper.prototype.write_qrs=function(pub,priv){var params;return params={width:256,height:256,colorLight:"#f8f8f4",correctLevel:QRCode.CorrectLevel.H},new QRCode("public-address-qr",params).makeCode(pub),new QRCode("private-key-qr",params).makeCode(priv)},Warper.prototype.click_submit=function(){return $("#btn-submit").attr("disabled",!0).html("Running..."),$("#btn-reset").attr("disabled",!0).html("Running..."),$("#passphrase, #salt, checkbox-salt-confirm").attr("disabled",!0),$(".progress-pbkdf2, .progress-scrypt").html(""),$(".progress-form").show(),warpwallet.run({passphrase:$("#passphrase").val(),salt:$("#salt").val(),progress_hook:function(_this){return function(o){return _this.progress_hook(o)}}(this),params:window.params},function(_this){return function(res){return $("#passphrase, #checkbox-salt-confirm").attr("disabled",!1),null==window.SALT_DEFAULT&&$("#salt").attr("disabled",!1),$(".progress-form").hide(),$(".output-form").show(),$("#btn-submit").hide(),$("#btn-reset").attr("disabled",!1).html("Clear &amp; reset"),$("#public-address").val(res["public"]),$("#private-key").val(res["private"]),_this.write_qrs(res["public"],res["private"]),console.log}}(this))},Warper}(),$(function(){return new Warper})}).call(this);